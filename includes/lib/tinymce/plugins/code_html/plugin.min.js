tinymce.PluginManager.add('code_html', function(editor, url) {
  // Add a button that opens a window
  editor.addButton('code_html', {
    text: '<code>',
    icon: false,
    onclick: function() {
      // Open window
      var node = editor.selection.getNode();
      if (editor.selection.isCollapsed()) {
        editor.formatter.toggle('code');
      } else {
        editor.formatter.toggle('code');
      }
    }
  });

  // Adds a menu item to the tools menu
  editor.addMenuItem('code_html', {
    text: '<code>',
    context: 'tools'
  });
});
